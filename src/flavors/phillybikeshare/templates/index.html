{% extends 'base.html' %}
{% load i18n %}
{% get_current_language as LANGUAGE_CODE %}

{% block site-title %}
<a href="/"><img id="site-logo" src="{{ config.static_url }}css/images/{% if LANGUAGE_CODE == 'es' %}logo-es.gif{% else %}logo.gif{% endif %}" title="{{ config.app.name }}"></a>
{% endblock %}

{% block meta %}
  {% if place %}
    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="{{ place.properties.name }}">
    <meta name="twitter:description" content="{{ place.properties.description }}">
    {% with attachment=place.properties.attachments|first %}
    <meta name="twitter:image:src" content="{{ attachment.file }}">
    {% endwith %}
    {% comment %} TODO: Fill this in when we know if the username is from twitter
      <meta name="twitter:creator" content="place.submitter.username">
    {% endcomment %}

    <!-- Facebook -->
    <meta property="og:site_name" content="{{ config.app.title }}" />
    <meta property="og:title" content="{{ place.properties.name }}" />
    <meta property="og:description" content="{{ place.properties.description }}" />
    {% with attachment=place.properties.attachments|first %}
    <meta name="og:image" content="{{ attachment.file }}">
    {% endwith %}
  {% else %}
    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="{{ config.app.title }}">
    <meta name="twitter:description" content="{{ config.app.meta_description }}">

    <!-- Facebook -->
    <meta property="og:site_name" content="{{ config.app.title }}" />
    <meta property="og:title" content="{{ config.app.title }}" />
    <meta property="og:description" content="{{ config.app.meta_description }}" />
  {% endif%}
{% endblock %}

<!--
  This will place content at the top of the side bar
 -->
{% block sidebar %}
{% endblock %}

<!--
  This will place content in the colophon below the map
 -->
{% block colophon %}
<p id="powered-by">{% blocktrans %}Powered by{% endblocktrans %} <a href="http://shareabouts.org/" class="shareabouts-logo" target="_blank">Shareabouts</a>, <span class="nobreak">a project of <a href="http://openplans.org/" class="openplans-logo" target="_blank">OpenPlans</a></span></p>
{% if config.map.geocoding_enabled %}
<p id="mapquest-attribution">| Geocoding Courtesy of <a href="http://www.mapquest.com/" target="_blank">MapQuest</a> <img src="http://developer.mapquest.com/content/osm/mq_logo.png">.</p>
{% endif %}
{% endblock %}

<!--
  Analytics, custom JS, and such go here
 -->
{% block includes %}
<script>
  (function(NS, $) {
    $(document).on('change', 'input[name="good_spot"]', function(evt) {
      var val = $(this).val(),
          $yesField = $('.survey-field-why_good'),
          $yesInput = $('input[name="why_good"]'),
          $noField = $('.survey-field-why_bad'),
          $noInput = $('input[name="why_bad"]');

      if (val === 'yes') {
        $yesField.show();
        $yesInput.attr('required', true);

        $noField.hide()
        $noInput.removeAttr('required').val('').prop('checked', false);
      } else if (val === 'no') {
        $yesField.hide();
        $yesInput.removeAttr('required').val('').prop('checked', false);

        $noField.show();
        $noInput.attr('required', true);
      } else {
        $yesField.hide();
        $yesInput.removeAttr('required').val('').prop('checked', false);

        $noField.hide();
        $noInput.removeAttr('required').val('').prop('checked', false);
      }
    });

    $(NS).on('panelshow', function() {
      // Fix the reply button action
      $('.reply-link').on('click', function(evt) {
        evt.preventDefault();
        var $panelScrollable = $('#content article').first(),
            $firstLabel = $('.survey').find('label').first();
        $panelScrollable.scrollTo($firstLabel);
      });
    });
  }(Shareabouts, jQuery));
</script>
{% endblock %}
